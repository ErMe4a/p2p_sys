{% extends 'base.html' %}
{% load l10n %}

{% block content %}

<style>
    :root {
        --bg-main: #0c0e16;
        --bg-card: #161a25;
        --border-color: #262c3d;
        --text-muted: #848e9c;
        --text-main: #eaecef;
        --accent-yellow: #f7a600; /* Цвет Bybit */
        --accent-red: #f6465d;    /* Цвет удаления */
        --info-bg: #182235;       /* Фон синей плашки */
        --info-text: #5d87ff;     /* Текст синей плашки */
    }

    body { background-color: var(--bg-main); color: var(--text-main); font-family: 'Inter', sans-serif; }

    /* Вкладки (как на других страницах) */
    .nav-tabs-custom { display: flex; gap: 20px; margin-bottom: 24px; border-bottom: 1px solid var(--border-color); padding-left: 10px; }
    .nav-tab { color: var(--text-muted); text-decoration: none; padding: 12px 4px; font-size: 14px; border-bottom: 2px solid transparent; transition: 0.2s; }
    .nav-tab:hover { color: var(--text-main); }
    .nav-tab.active { color: #3d5afe; border-bottom-color: #3d5afe; font-weight: 600; }

    /* Информационная плашка */
    .alert-custom-blue {
        background-color: rgba(61, 90, 254, 0.1);
        border: 1px solid rgba(61, 90, 254, 0.2);
        color: #8da4ef;
        border-radius: 6px;
        padding: 12px 16px;
        font-size: 13px;
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
    }
    .alert-custom-blue i { font-size: 14px; }

    /* Контейнер таблицы */
    .table-card {
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        overflow: hidden;
    }

    /* Верхняя панель таблицы (Пагинация) */
    .table-header-panel {
        display: flex;
        justify-content: flex-end; /* Пагинация справа */
        padding: 10px 15px;
        border-bottom: 1px solid var(--border-color);
    }
    
    .pagination-controls {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .btn-page {
        background: #2b3139;
        border: none;
        color: var(--text-main);
        width: 24px;
        height: 24px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        cursor: pointer;
    }
    .btn-page:hover { background: #38404b; }
    .page-info { font-size: 12px; color: var(--text-muted); }

    /* Таблица */
    .table { margin-bottom: 0; font-size: 13px; color: var(--text-main); }
    .table thead th {
        background-color: rgba(255, 255, 255, 0.02);
        color: var(--text-muted);
        font-weight: 500;
        font-size: 11px;
        text-transform: uppercase;
        border-bottom: 1px solid var(--border-color);
        padding: 12px 15px;
    }
    .table td {
        border-bottom: 1px solid var(--border-color);
        padding: 10px 15px;
        vertical-align: middle;
    }
    .table tr:last-child td { border-bottom: none; }

    /* Стили колонок */
    .col-id { font-weight: 600; color: #fff; }
    .col-type-buy { color: var(--text-muted); } /* На скрине просто серый текст */
    .col-type-sell { color: var(--text-muted); }

    /* Кнопки действий */
    .btn-bybit {
        background-color: var(--accent-yellow);
        color: #000;
        font-weight: 600;
        font-size: 11px;
        padding: 4px 12px;
        border-radius: 4px;
        text-decoration: none;
        border: none;
        display: inline-block;
    }
    .btn-bybit:hover { background-color: #e59b00; color: #000; }

    .btn-delete-row {
        background-color: #3d2428;
        color: #f84960;
        border: 1px solid #5a2d2d;
        font-size: 11px;
        padding: 4px 12px;
        border-radius: 4px;
        text-decoration: none;
        margin-left: 6px;
        transition: 0.2s;
    }
    .btn-delete-row:hover {
        background-color: #f84960;
        color: #fff;
        border-color: #f84960;
    }
    
    /* Скроллбар для таблицы */
    .table-responsive::-webkit-scrollbar { height: 6px; }
    .table-responsive::-webkit-scrollbar-track { background: var(--bg-card); }
    .table-responsive::-webkit-scrollbar-thumb { background: #2b3139; border-radius: 3px; }
</style>


<div class="container-fluid px-0">
    
    <div class="alert-custom-blue">
        <span>ℹ️</span> Ордера с бирж HTX и MEXC пока не выгружаются в этот раздел
    </div>



        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>ID ордера</th>
                        <th>Тип</th>
                        <th>Цена</th>
                        <th>Кол-во</th>
                        <th>Создан</th>
                        <th class="text-center">Действия</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in unprocessed_orders %}
                    <tr>
                        <td class="col-id">{{ item.order_id }}</td>
                        
                        <td>
                            {% if item.operation_type == 'BUY' %}
                                <span class="col-type-buy">Покупка</span>
                            {% else %}
                                <span class="col-type-sell">Продажа</span>
                            {% endif %}
                        </td>
                        
                        <td>{{ item.price|default:"—" }}</td>
                        
                        <td>{{ item.amount }}</td>
                        
                        <td class="text-muted">{{ item.created_at|date:"d.m.Y, H:i:s" }}</td>
                        
                        <td class="text-end">
                            <a href="https://www.bybit.com/fiat/trade/otc/order/{{ item.order_id }}" target="_blank" class="btn-bybit">
                                Bybit
                            </a>
                            <a href="#" class="btn-delete-row" onclick="return confirm('Удалить из списка?')">
                                Удалить
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="text-center py-5 text-muted">
                            Список пуст. Новых ордеров не найдено.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

{% endblock %}